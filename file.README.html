<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; ElectionBuddy Ruby
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="electionbuddy-ruby">ElectionBuddy Ruby</h1>

<p>A Ruby client for interacting with the <a href="https://api.electionbuddy.com">ElectionBuddy API</a>.
Explore the complete documentation at <a href="https://electionbuddy.github.io/electionbuddy-ruby">https://electionbuddy.github.io/electionbuddy-ruby</a>.</p>

<h2 id="installation">Installation</h2>

<p>Install the gem and add it to the application&#39;s Gemfile by executing:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_add'>add</span> <span class='id identifier rubyid_electionbuddy'>electionbuddy</span><span class='op'>-</span><span class='id identifier rubyid_ruby'>ruby</span>
</code></pre>

<p>If bundler is not being used to manage dependencies, install the gem by executing:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_electionbuddy'>electionbuddy</span><span class='op'>-</span><span class='id identifier rubyid_ruby'>ruby</span>
</code></pre>

<p>Alternatively, add the gem to the Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>electionbuddy-ruby</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<h2 id="usage">Usage</h2>

<p>Ensure you have an API key from Electionbuddy. You can configure the API key globally or initialize the client directly with the API key.</p>

<h3 id="global-configuration">Global Configuration</h3>

<h4 id="example-in-a-rails-application">Example in a Rails application</h4>

<p>Create an initializer file in <code>config/initializers/electionbuddy.rb</code> and add the following code:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="ElectionBuddy.html" title="ElectionBuddy (module)">ElectionBuddy</a></span></span><span class='period'>.</span><span class='id identifier rubyid_configure'><span class='object_link'><a href="ElectionBuddy.html#configure-class_method" title="ElectionBuddy.configure (method)">configure</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'>config</span><span class='op'>|</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_api_key'>api_key</span> <span class='op'>=</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_electionbuddy'>electionbuddy</span><span class='lbracket'>[</span><span class='symbol'>:api_key</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</code></pre>

<h4 id="client-initialization">Client Initialization</h4>

<p>You can now initialize the client without passing the API key if it has been configured globally:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ElectionBuddy.html" title="ElectionBuddy (module)">ElectionBuddy</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ElectionBuddy/Client.html" title="ElectionBuddy::Client (class)">Client</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ElectionBuddy/Client.html#initialize-instance_method" title="ElectionBuddy::Client#initialize (method)">new</a></span></span>
</code></pre>

<p>Alternatively, you can still pass the API key directly during initialization. If the API key is passed during initialization, it will take precedence over the global configuration.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ElectionBuddy.html" title="ElectionBuddy (module)">ElectionBuddy</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ElectionBuddy/Client.html" title="ElectionBuddy::Client (class)">Client</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ElectionBuddy/Client.html#initialize-instance_method" title="ElectionBuddy::Client#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>api_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>your-api-key</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<h3 id="voter-list-importation">Voter List Importation</h3>

<p>To import a voter list for an election, use the <code>voter_list.import(vote_id, voters, append_mode: false)</code> method:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_voters'>voters</span> <span class='op'>=</span> <span class='lbracket'>[</span>
  <span class='lbrace'>{</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>voter1@example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>label:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Voter One</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>voter2@example.com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>label:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Voter Two</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='rbracket'>]</span>

<span class='id identifier rubyid_import'>import</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_voter_list'>voter_list</span><span class='period'>.</span><span class='id identifier rubyid_import'>import</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_voters'>voters</span><span class='comma'>,</span> <span class='label'>append_mode:</span> <span class='kw'>false</span><span class='rparen'>)</span>

<span class='kw'>if</span> <span class='id identifier rubyid_import'>import</span><span class='period'>.</span><span class='id identifier rubyid_done?'>done?</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Import completed successfully! Identifier: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_import'>import</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Import failed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_import'>import</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>The <code>append_mode</code> parameter determines whether the voters should be appended to the existing list (<code>true</code>) or replace the existing list (<code>false</code>). The default value is <code>false</code>.</p>

<h3 id="voter-list-validation">Voter List Validation</h3>

<p>To validate a voter list, use the <code>voter_list.validate(vote_id)</code> method:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_validation'>validation</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_voter_list'>voter_list</span><span class='period'>.</span><span class='id identifier rubyid_validate'>validate</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>

<span class='kw'>if</span> <span class='id identifier rubyid_validation'>validation</span><span class='period'>.</span><span class='id identifier rubyid_done?'>done?</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Validation completed successfully! Identifier: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_validation'>validation</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Validation failed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_validation'>validation</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<h3 id="get-the-validation-result">Get the Validation Result</h3>

<p>Once you have a validation identifier, you can check the validation results. </p>

<pre class="code ruby"><code class="ruby"><span class='kw'>begin</span>
  <span class='id identifier rubyid_validation_result'>validation_result</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_voter_list'>voter_list</span><span class='period'>.</span><span class='id identifier rubyid_validation_result'>validation_result</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ae0a1724-9791-4bb2-8331-6d4e55a9b7c8</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_validation_result'>validation_result</span><span class='period'>.</span><span class='id identifier rubyid_valid?'>valid?</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The voter list is valid!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The voter list is invalid!</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Total errors count: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_validation_result'>validation_result</span><span class='period'>.</span><span class='id identifier rubyid_total_errors_count'>total_errors_count</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="ElectionBuddy.html" title="ElectionBuddy (module)">ElectionBuddy</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ElectionBuddy/Error.html" title="ElectionBuddy::Error (class)">Error</a></span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Something went wrong: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>The voter list validation can have two types of errors:</p>

<ol>
<li><strong>List-level errors</strong>: Affect the entire voter list (e.g., missing required columns)</li>
<li><strong>Line-level errors</strong>: Affect specific lines in the voter list (e.g., invalid email format)</li>
</ol>

<h4 id="list-level-errors">List-Level Errors</h4>

<p>List-level errors can be retrieved using the <code>list_errors</code> method.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>if</span> <span class='id identifier rubyid_validation_result'>validation_result</span><span class='period'>.</span><span class='id identifier rubyid_list_errors'>list_errors</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>List-level errors:</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_validation_result'>validation_result</span><span class='period'>.</span><span class='id identifier rubyid_list_errors'>list_errors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_list_error'>list_error</span><span class='op'>|</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error message: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_list_error'>list_error</span><span class='period'>.</span><span class='id identifier rubyid_error_message'>error_message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<h4 id="line-level-errors">Line-Level Errors</h4>

<p>Line-level errors are paginated. You can specify the page number and the number of errors per page.
If you don&#39;t specify the page number and the number of errors per page, the default values are 1 and 10, respectively.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_validation_result'>validation_result</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_voter_list'>voter_list</span><span class='period'>.</span><span class='id identifier rubyid_validation_result'>validation_result</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ae0a1724-9791-4bb2-8331-6d4e55a9b7c8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>page:</span> <span class='int'>2</span><span class='comma'>,</span> <span class='label'>per_page:</span> <span class='int'>10</span><span class='rparen'>)</span>
<span class='id identifier rubyid_line_errors'>line_errors</span> <span class='op'>=</span> <span class='id identifier rubyid_validation_result'>validation_result</span><span class='period'>.</span><span class='id identifier rubyid_line_errors'>line_errors</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There is a total of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_total'>total</span><span class='embexpr_end'>}</span><span class='tstring_content'> line-level errors.</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The current page is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_per_page'>per_page</span><span class='embexpr_end'>}</span><span class='tstring_content'> errors per page.</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_total_pages'>total_pages</span><span class='embexpr_end'>}</span><span class='tstring_content'> pages in total.</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>PS: The <code>list_errors</code> object is always available, regardless of the line-level errors pagination.</p>

<p>To iterate over the line-level errors, you can use the following code:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>if</span> <span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Line-level errors for page </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_line_errors'>line_errors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line_error'>line_error</span><span class='op'>|</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Line identifier: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_error'>line_error</span><span class='period'>.</span><span class='id identifier rubyid_voter_information_line_id'>voter_information_line_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error messages:</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_line_error'>line_error</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line_error'>line_error</span><span class='op'>|</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error messages </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line_error'>line_error</span><span class='period'>.</span><span class='id identifier rubyid_error_messages'>error_messages</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<h3 id="possible-api-errors">Possible API Errors</h3>

<p>The following errors may be raised by the API:</p>

<ul>
<li><strong>400</strong>: Malformed request.</li>
<li><strong>401</strong>: Invalid authentication credentials.</li>
<li><strong>403</strong>: Unauthorized.</li>
<li><strong>404</strong>: Resource not found.</li>
<li><strong>429</strong>: Your request exceeded the API rate limit.</li>
<li><strong>500</strong>: We were unable to perform the request due to server-side problems.</li>
</ul>

<p>Each error will raise an <code>Error</code> exception with a message detailing the status code and the error message returned by the API.</p>

<h2 id="documentation">Documentation</h2>

<p>The complete documentation for this gem is available at: <a href="https://electionbuddy.github.io/electionbuddy-ruby">https://electionbuddy.github.io/electionbuddy-ruby</a></p>

<p>You can also generate the documentation locally using:</p>

<pre class="code bash"><code class="bash">yard doc
yard server
</code></pre>

<h2 id="development">Development</h2>

<p>After checking out the repo, run <code>bin/setup</code> to install dependencies. Then, run <code>rake test</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p>

<p>To install this gem onto your local machine, run <code>bundle exec rake install</code>. To release a new version, update the version number in <code>version.rb</code>, and then run <code>bundle exec rake release</code>, which will create a git tag for the version, push git commits and the created tag, and push the <code>.gem</code> file to <a href="https://rubygems.org">rubygems.org</a>.</p>

<h2 id="contributing">Contributing</h2>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/electionbuddy/electionbuddy-ruby">https://github.com/electionbuddy/electionbuddy-ruby</a>.</p>

<h2 id="license">License</h2>

<p>The gem is available as open source under the terms of the <a href="https://opensource.org/licenses/MIT">MIT License</a>.</p>
</div></div>

      <div id="footer">
  Generated on Wed Nov 20 18:05:54 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.3.5).
</div>

    </div>
  </body>
</html>